<template id="contentTmpl">
    <div class="main_content">

		<section id="modifyOpts" class="modifymobile_content _02" style="display:block;">
		    <div class="flt-header">
		        <span class="icon icon62 icon-left"></span>
		        <span>经过安全监测，您可以通过以下方式添加银行卡</span>
		    </div>
		    <div class="layout_form">
		        <div class="form_field_wrap">
		            <a forward="inside" newview="true" href="customer/bank_verify.htm" class="form_field" v-show="isPhoneVisible">
		                <div class="icon-content"><img src="../../__static/__images/icons/sms_green.png"></div>
		                <div class="input_wrap">
		                    <h4 class="title">通过短信验证 <span class="icon icon63"></span></h4>
		                    <span class="desc">选择此方式，我们将向您号码为{{mobile}}的手机发送验证码</span>
		                </div>
		            </a>  
		            <div class="clearfix" v-show="isPhoneVisible"></div>

		            <a @click="manualInside" class="form_field" v-show="isManualVisible">
		                <div class="icon-content"><img src="../../__static/__images/icons/icon05.png"></div>
		                <div class="input_wrap">
		                    <h4 class="title">通过人工服务</h4>
		                    <span class="desc">原绑定手机无法接收验证码？提交申请，等待人工客服协助修改</span>
		                </div>
		            </a>  
		            <div class="clearfix" v-show="isManualVisible"></div>

		        </div>
		    </div>
		</section>
	</div>
</template>
<script>
;(function() {
   var contentData = {
        'isPhoneVisible': true,
        'isManualVisible': false,
        'mobile': ''
    };
	appState.setData({
	    title: '添加银行卡',
		needLogin: true
	});
	Vue.component("app-content", {
	    template: "#contentTmpl",
	    data: function () {
	        return contentData;
	    },
	    methods: {
	    	manualInside: function() {
	    		isAllowAddBankCard();
	    		JSBridge.forward.inside({url: "customer/bank_add.htm", newView: true});
	    	}
	    }
	});
	
	function isAllowAddBankCard(){
		JSBridge.cache.save("bankCardAddStatusData", {
            data: {"status": true},
            outtime: new Date().getTime() + 10000
        }, 1);
	}
	
	JSBridge.onReady(function() {
	    var _this = contentData;
	    var dataCache = JSBridge.cache.get("bankCardVerifyMothodData");
	    if (dataCache && new Date().getTime() < dataCache.outtime) {
	        var obj = dataCache.data;
	        _this.isPhoneVisible = obj.phone ? obj.phone : false;
	        _this.isManualVisible = obj.manual ? obj.manual : false;
	    }
	    
	    var customer = JSBridge.cache.get("customer");
	    _this.mobile = customer.phone ? customer.phone.substring(0,3) + "****" + customer.phone.substr(-4) : "";
	});
})();
</script>