!function(e){function t(e){return e?(/^https?:\/\//.test(e)||(e="http://"+e),/\/$/.test(e)||(e+="/"),e):""}var n=APP_CONSTANTS.businessUrls;JSBridge.registerFunction("netErrorEvent",function(e){if(e&&405==e.httpCode)return CustomerUtils.clear(),JSBridge.forward.inside({url:n.login,newView:!0}),!1}),e.CheckUtil=function(){return{infoCompleted:function(e,t){function r(e){t?t(e):JSBridge.forward.inside({url:n.completeInfo+"?from="+OtherUtils.getPath(),newView:!0})}var i=JSBridge.cache.get("customer");i&&i.real_name&&i.verify_code?e(i):JSBridge.net.invoke({loading:!1,url:"users/userInfo",success:function(t){t&&t.WSCustomers?(i=Object.assign(i,t.WSCustomers),JSBridge.cache.update("customer",i),i.real_name&&i.verify_code?e(i):r()):r()},error:r})},mobileBinded:function(e,t){JSBridge.net.invoke({loading:!1,url:"verify/isBind",data:{type:"1"},success:e,error:function(e){t?t(e):JSBridge.forward.inside({url:n.bindMobile+"?from="+OtherUtils.getPath(),newView:!0})}})},emailBinded:function(e,t){JSBridge.net.invoke({loading:!1,url:"verify/isBind",data:{type:"2"},success:e,error:function(e){t?t(e):JSBridge.forward.inside({url:n.bindEmail+"?from="+OtherUtils.getPath(),newView:!0})}})},cardBinded:function(e,t){function r(e){t?t(e):JSBridge.forward.inside({url:n.bindCard+"?from="+OtherUtils.getPath(),newView:!0})}JSBridge.net.invoke({loading:!1,url:"bankcard/getList",data:{flag:"1",order:"PRIORITY_ORDER",delete_flag:"0"},success:function(t){t&&t.length?e(t):r()},error:r})},isPendingBankApply:function(e,t){JSBridge.net.invoke({loading:!1,url:"bankcard/isApplied",success:function(n){"function"!=typeof t&&(t=function(){}),parseInt(n)>0?t():e()},error:e})}}}(),e.Request={approve:function(e,t,n,r){JSBridge.net.invoke({url:"apply/approve",data:{request_id:e,request_type:t},success:function(e){"Function"!=typeof r&&(r=function(){}),e?n():r()},error:r})},totalBalance:function(e){void 0!==e.balance?JSBridge.net.invoke({loading:!1,url:"credits/total",data:{withAP:0},success:function(t){e.balance=t},error:function(){e.balance=0}}):console.log("对象必须有balance属性")},userInfo:function(e,t){JSBridge.net.invoke({loading:!1,url:"users/userInfo",success:function(n){n&&n.WSCustomers||t(),e(n.WSCustomers)},error:t})}},e.CustomerUtils=function(){function e(){return JSBridge.cache.get("customer")}var t=localStorage,n={set:function(e,t,n){document.cookie=e+"="+t+";path=/;expires="+n},delete:function(e){document.cookie=e+"=;path=/"},get:function(e){var t=document.cookie.split(";");return(t?function(){var e={};return t.forEach(function(t,n){var r=t.split("=");e[r[0]]=r[1]}),e}():{})[e]}};return{save:function(e){JSBridge.driver.clearCookie(),t.setItem("isLoged",!0),n.set("isLoged","1",31536e6),JSBridge.cache.save("customer",e,1)},isLoged:function(){if($.appVersion().isAndroid)return!!CustomerUtils.getCustomer();var e=t.getItem("isLoged");return e||(e="1"===n.get("isLoged")),e},clear:function(){t.removeItem("isLoged"),JSBridge.cache.delete("customer"),n.delete("isLoged"),JSBridge.driver.clearCookie()},getCustomer:e,loadCustomer:function(t){JSBridge.net.invoke({loading:!1,url:"users/userInfo",success:function(n){var r=n.WSCustomers;JSBridge.cache.save("customer",Object.assign(e(),r),1),t(r)},error:function(e){e&&$.toast.fail(e.message),t()}})}}}(),e.OtherUtils={mixPhone:function(e){return e.substring(0,3)+"****"+e.substring(7)},mixBankCardNo:function(e){return e.substring(0,4)+"***********"+e.substring(15)},getPath:function(){var e=location.href.split("/").slice(-2).join("/");return encodeURIComponent(e)},formatOutsideUrl:function(e){return e.match(/^http/)||!e.match(/^[\w]+\.htm/)?e:OtherUtils.getDomain()+e},getStaticurl:function(){var e;return function(){return e||((e=JSBridge.cache.get("staticurl"))||(e=JSBridge.cache.get("cdnurl"))||(e=OtherUtils.getDomain()),e?(e=t(e),JSBridge.cache.save("staticurl",e)):e=t(location.host)),e}}(),getDomain:function(){var e;return function(){return e||(e=t(e=JSBridge.cache.get("domain"))),e}}()},function(e){if(e&&e.length){var t=decodeURIComponent(OtherUtils.getPath());e.includes(t)&&JSBridge.registerFunction("invoke.net.invoke",function(e){e.data.loading=!1})}}(APP_CONSTANTS.stealthyNetUrls),function(){function e(e){var t,n,r,i,o,s,a=[];t=(JSBridge.driver.getSessionId()||{}).sessionId,n=(JSBridge.driver.deviceInfo()||{}).drice_id,i=(o=e.url.split("?"))[0],o.length>1&&(o[1].split("&").forEach(function(e,t){e&&!/^((user|app)Token|accountName)=.*/.test(e)&&a.push(e)}),a.length&&(i+="?"+a.join("&"))),CustomerUtils.isLoged()&&(s=CustomerUtils.getCustomer())&&(r=s.login_name),JSBridge.net.invokeSync("app/dynatrace",{loading:!1,app_sess_id:t,page_name:i,device_id:n,click_time:Date.format(new Date,"yyyy-MM-dd HH:mm:ss"),action_data:e.remark||"APP原生跳转",login_name:r})}$.appVersion().isApp&&(JSBridge.loadFinish(function(){e({url:decodeURIComponent(OtherUtils.getPath()),remark:""})}),JSBridge.registerFunction("invoke.forward",function(t){if("forward.outside"==t.type){var n="外部页面";t.data.gameType&&(n="进入游戏: "+t.data.gameType,/(gameType|gameId)\=(fish|6)/.test(t.data.url)&&(n="进入游戏: 捕鱼王2")),e({url:t.data.url,remark:n})}}),JSBridge.registerFunction("invoke.driver.game",function(t){e({url:"local AGQJ",remark:"进入游戏: AGQJ"})}))}()}(window);